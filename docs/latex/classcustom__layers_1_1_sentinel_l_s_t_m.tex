\hypertarget{classcustom__layers_1_1_sentinel_l_s_t_m}{}\doxysection{custom\+\_\+layers.\+Sentinel\+L\+S\+TM Class Reference}
\label{classcustom__layers_1_1_sentinel_l_s_t_m}\index{custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}}
Inheritance diagram for custom\+\_\+layers.\+Sentinel\+L\+S\+TM\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classcustom__layers_1_1_sentinel_l_s_t_m}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classcustom__layers_1_1_sentinel_l_s_t_m_a5ded75880fbfbf0aba87a38b1443e351}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, input\+\_\+size, hidden\+\_\+size, \mbox{\hyperlink{classcustom__layers_1_1_sentinel_l_s_t_m_a39cd6e56ab5555d896226fac61de22c6}{n}}=0)
\item 
def \mbox{\hyperlink{classcustom__layers_1_1_sentinel_l_s_t_m_ac1376a5d2d53160cad2b333bf45bf561}{forward}} (self, x, states)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classcustom__layers_1_1_sentinel_l_s_t_m_a39cd6e56ab5555d896226fac61de22c6}{n}}
\item 
\mbox{\hyperlink{classcustom__layers_1_1_sentinel_l_s_t_m_ad1bf7b9839616d447cf2e40a57f39dac}{lstm\+\_\+cells}}
\item 
\mbox{\hyperlink{classcustom__layers_1_1_sentinel_l_s_t_m_aacc7187618e62481656382627dd34f92}{lstm\+\_\+kernel}}
\item 
\mbox{\hyperlink{classcustom__layers_1_1_sentinel_l_s_t_m_a23c98d5f059e047f467a52aaa7c1c9e9}{x\+\_\+gate}}
\item 
\mbox{\hyperlink{classcustom__layers_1_1_sentinel_l_s_t_m_aa00cccc5ab1b7ab90a92d5a0b2f7f7d6}{h\+\_\+gate}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line 6 of file custom\+\_\+layers.\+py.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classcustom__layers_1_1_sentinel_l_s_t_m_a5ded75880fbfbf0aba87a38b1443e351}\label{classcustom__layers_1_1_sentinel_l_s_t_m_a5ded75880fbfbf0aba87a38b1443e351}} 
\index{custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def custom\+\_\+layers.\+Sentinel\+L\+S\+T\+M.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{input\+\_\+size,  }\item[{}]{hidden\+\_\+size,  }\item[{}]{n = {\ttfamily 0} }\end{DoxyParamCaption})}



Definition at line 8 of file custom\+\_\+layers.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{8     \textcolor{keyword}{def }\_\_init\_\_(self, input\_size, hidden\_size, n=0):}
\DoxyCodeLine{9         super(SentinelLSTM, self).\_\_init\_\_()}
\DoxyCodeLine{10         \textcolor{comment}{\# NB! there is a difference between LSTMCell and LSTM.}}
\DoxyCodeLine{11         \textcolor{comment}{\# LSTM is notably much quicker}}
\DoxyCodeLine{12         self.n = n}
\DoxyCodeLine{13         self.lstm\_cells = []}
\DoxyCodeLine{14         \textcolor{keywordflow}{if} n:}
\DoxyCodeLine{15             inp\_size = hidden\_size}
\DoxyCodeLine{16         \textcolor{keywordflow}{else}:}
\DoxyCodeLine{17             inp\_size = input\_size}
\DoxyCodeLine{18         self.lstm\_kernel = nn.LSTMCell(inp\_size, hidden\_size)}
\DoxyCodeLine{19         self.x\_gate = nn.Linear(inp\_size, hidden\_size)}
\DoxyCodeLine{20         self.h\_gate = nn.Linear(hidden\_size, hidden\_size)}
\DoxyCodeLine{21 }
\DoxyCodeLine{22         inp\_size = input\_size}
\DoxyCodeLine{23         hid\_size = hidden\_size}
\DoxyCodeLine{24         \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(self.n):}
\DoxyCodeLine{25             self.lstm\_cells.append(nn.LSTMCell(inp\_size, hid\_size))}
\DoxyCodeLine{26             inp\_size = hid\_size}
\DoxyCodeLine{27 }

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcustom__layers_1_1_sentinel_l_s_t_m_ac1376a5d2d53160cad2b333bf45bf561}\label{classcustom__layers_1_1_sentinel_l_s_t_m_ac1376a5d2d53160cad2b333bf45bf561}} 
\index{custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}!forward@{forward}}
\index{forward@{forward}!custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}}
\doxysubsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def custom\+\_\+layers.\+Sentinel\+L\+S\+T\+M.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{x,  }\item[{}]{states }\end{DoxyParamCaption})}



Definition at line 28 of file custom\+\_\+layers.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{28     \textcolor{keyword}{def }forward(self, x, states):}
\DoxyCodeLine{29         \textcolor{comment}{\# print('Sentinel LSTM')}}
\DoxyCodeLine{30         \textcolor{comment}{\# remember old states}}
\DoxyCodeLine{31         h\_tm1, c\_tm1 = states}
\DoxyCodeLine{32         \textcolor{comment}{\# new states lists}}
\DoxyCodeLine{33         hs = torch.zeros(h\_tm1.size())}
\DoxyCodeLine{34         cs = torch.zeros(c\_tm1.size())}
\DoxyCodeLine{35         inputs = x}
\DoxyCodeLine{36         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(self.n):}
\DoxyCodeLine{37             \textcolor{comment}{\# feed layers the correct h and c states}}
\DoxyCodeLine{38             h, c = self.lstm\_cells[i](inputs, (h\_tm1[i], c\_tm1[i]))}
\DoxyCodeLine{39             hs[i] = h}
\DoxyCodeLine{40             cs[i] = c}
\DoxyCodeLine{41             \textcolor{comment}{\# add residual}}
\DoxyCodeLine{42             inputs = h + inputs}
\DoxyCodeLine{43 }
\DoxyCodeLine{44         \textcolor{comment}{\# get new states}}
\DoxyCodeLine{45         h\_t, c\_t = self.lstm\_kernel(inputs, (h\_tm1[-\/1], c\_tm1[-\/1]))}
\DoxyCodeLine{46         hs[-\/1] = h\_t}
\DoxyCodeLine{47         cs[-\/1] = c\_t}
\DoxyCodeLine{48 }
\DoxyCodeLine{49         \textcolor{comment}{\# compute sentinel vector}}
\DoxyCodeLine{50         \textcolor{comment}{\# could either concat h\_tm1 with x or have to gates}}
\DoxyCodeLine{51         sv = torch.sigmoid(self.h\_gate(h\_tm1[-\/1]) + self.x\_gate(inputs))}
\DoxyCodeLine{52         s\_t = sv * torch.tanh(c\_t)}
\DoxyCodeLine{53         \textcolor{keywordflow}{return} hs, cs, h\_t, s\_t}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 }

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classcustom__layers_1_1_sentinel_l_s_t_m_aa00cccc5ab1b7ab90a92d5a0b2f7f7d6}\label{classcustom__layers_1_1_sentinel_l_s_t_m_aa00cccc5ab1b7ab90a92d5a0b2f7f7d6}} 
\index{custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}!h\_gate@{h\_gate}}
\index{h\_gate@{h\_gate}!custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}}
\doxysubsubsection{\texorpdfstring{h\_gate}{h\_gate}}
{\footnotesize\ttfamily custom\+\_\+layers.\+Sentinel\+L\+S\+T\+M.\+h\+\_\+gate}



Definition at line 20 of file custom\+\_\+layers.\+py.

\mbox{\Hypertarget{classcustom__layers_1_1_sentinel_l_s_t_m_ad1bf7b9839616d447cf2e40a57f39dac}\label{classcustom__layers_1_1_sentinel_l_s_t_m_ad1bf7b9839616d447cf2e40a57f39dac}} 
\index{custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}!lstm\_cells@{lstm\_cells}}
\index{lstm\_cells@{lstm\_cells}!custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}}
\doxysubsubsection{\texorpdfstring{lstm\_cells}{lstm\_cells}}
{\footnotesize\ttfamily custom\+\_\+layers.\+Sentinel\+L\+S\+T\+M.\+lstm\+\_\+cells}



Definition at line 13 of file custom\+\_\+layers.\+py.

\mbox{\Hypertarget{classcustom__layers_1_1_sentinel_l_s_t_m_aacc7187618e62481656382627dd34f92}\label{classcustom__layers_1_1_sentinel_l_s_t_m_aacc7187618e62481656382627dd34f92}} 
\index{custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}!lstm\_kernel@{lstm\_kernel}}
\index{lstm\_kernel@{lstm\_kernel}!custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}}
\doxysubsubsection{\texorpdfstring{lstm\_kernel}{lstm\_kernel}}
{\footnotesize\ttfamily custom\+\_\+layers.\+Sentinel\+L\+S\+T\+M.\+lstm\+\_\+kernel}



Definition at line 18 of file custom\+\_\+layers.\+py.

\mbox{\Hypertarget{classcustom__layers_1_1_sentinel_l_s_t_m_a39cd6e56ab5555d896226fac61de22c6}\label{classcustom__layers_1_1_sentinel_l_s_t_m_a39cd6e56ab5555d896226fac61de22c6}} 
\index{custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}!n@{n}}
\index{n@{n}!custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}}
\doxysubsubsection{\texorpdfstring{n}{n}}
{\footnotesize\ttfamily custom\+\_\+layers.\+Sentinel\+L\+S\+T\+M.\+n}



Definition at line 12 of file custom\+\_\+layers.\+py.

\mbox{\Hypertarget{classcustom__layers_1_1_sentinel_l_s_t_m_a23c98d5f059e047f467a52aaa7c1c9e9}\label{classcustom__layers_1_1_sentinel_l_s_t_m_a23c98d5f059e047f467a52aaa7c1c9e9}} 
\index{custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}!x\_gate@{x\_gate}}
\index{x\_gate@{x\_gate}!custom\_layers.SentinelLSTM@{custom\_layers.SentinelLSTM}}
\doxysubsubsection{\texorpdfstring{x\_gate}{x\_gate}}
{\footnotesize\ttfamily custom\+\_\+layers.\+Sentinel\+L\+S\+T\+M.\+x\+\_\+gate}



Definition at line 19 of file custom\+\_\+layers.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/models/\mbox{\hyperlink{custom__layers_8py}{custom\+\_\+layers.\+py}}\end{DoxyCompactItemize}
