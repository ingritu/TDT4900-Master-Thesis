\hypertarget{namespacehandle__karpathy__split}{}\doxysection{handle\+\_\+karpathy\+\_\+split Namespace Reference}
\label{namespacehandle__karpathy__split}\index{handle\_karpathy\_split@{handle\_karpathy\_split}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespacehandle__karpathy__split_a832828cdfbce5ebae08e00c301006ad3}{order\+\_\+raw\+\_\+data\+\_\+and\+\_\+move\+\_\+to\+\_\+interim}} (data\+\_\+path, dataset, ann\+\_\+path)
\item 
def \mbox{\hyperlink{namespacehandle__karpathy__split_a8ecdcbe3665e9190f12c27f9a0298af3}{initialize\+\_\+full\+\_\+dict}} ()
\item 
def \mbox{\hyperlink{namespacehandle__karpathy__split_a21588438406dd53f7fa160f0aa69ace9}{initialize\+\_\+ann\+\_\+dict}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacehandle__karpathy__split_a8e624b6febe4083c1e5950645c0e08b8}{R\+O\+O\+T\+\_\+\+P\+A\+TH}} = Path(\+\_\+\+\_\+file\+\_\+\+\_\+).absolute().parents\mbox{[}2\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespacehandle__karpathy__split_a21588438406dd53f7fa160f0aa69ace9}\label{namespacehandle__karpathy__split_a21588438406dd53f7fa160f0aa69ace9}} 
\index{handle\_karpathy\_split@{handle\_karpathy\_split}!initialize\_ann\_dict@{initialize\_ann\_dict}}
\index{initialize\_ann\_dict@{initialize\_ann\_dict}!handle\_karpathy\_split@{handle\_karpathy\_split}}
\doxysubsubsection{\texorpdfstring{initialize\_ann\_dict()}{initialize\_ann\_dict()}}
{\footnotesize\ttfamily def handle\+\_\+karpathy\+\_\+split.\+initialize\+\_\+ann\+\_\+dict (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 134 of file handle\+\_\+karpathy\+\_\+split.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{134 \textcolor{keyword}{def }\mbox{\hyperlink{namespacehandle__karpathy__split_a21588438406dd53f7fa160f0aa69ace9}{initialize\_ann\_dict}}():}
\DoxyCodeLine{135     init\_dict = \{}
\DoxyCodeLine{136         \textcolor{stringliteral}{"info"}: \{}
\DoxyCodeLine{137             \textcolor{stringliteral}{"description"}: \textcolor{stringliteral}{"description"},}
\DoxyCodeLine{138             \textcolor{stringliteral}{"url"}: \textcolor{stringliteral}{"www"},}
\DoxyCodeLine{139             \textcolor{stringliteral}{"version"}: 1.0,}
\DoxyCodeLine{140             \textcolor{stringliteral}{"year"}: 2020,}
\DoxyCodeLine{141             \textcolor{stringliteral}{"contributor"}: \textcolor{stringliteral}{"contributor"},}
\DoxyCodeLine{142             \textcolor{stringliteral}{"date\_created"}: \textcolor{stringliteral}{"yyyy-\/mm-\/dd hh:mm:ss"}}
\DoxyCodeLine{143         \},}
\DoxyCodeLine{144         \textcolor{stringliteral}{"images"}: [],}
\DoxyCodeLine{145         \textcolor{stringliteral}{"licenses"}: [],}
\DoxyCodeLine{146         \textcolor{stringliteral}{"type"}: \textcolor{stringliteral}{"captions"},}
\DoxyCodeLine{147         \textcolor{stringliteral}{"annotations"}: []}
\DoxyCodeLine{148     \}}
\DoxyCodeLine{149     ann\_dict = \{}
\DoxyCodeLine{150         \textcolor{stringliteral}{"test"}: \{\},}
\DoxyCodeLine{151         \textcolor{stringliteral}{"val"}: \{\},}
\DoxyCodeLine{152         \textcolor{stringliteral}{"train"}: \{\}}
\DoxyCodeLine{153     \}}
\DoxyCodeLine{154     \textcolor{keywordflow}{for} key \textcolor{keywordflow}{in} ann\_dict:}
\DoxyCodeLine{155         ann\_dict[key] = deepcopy(init\_dict)}
\DoxyCodeLine{156     \textcolor{keywordflow}{return} ann\_dict}

\end{DoxyCode}
\mbox{\Hypertarget{namespacehandle__karpathy__split_a8ecdcbe3665e9190f12c27f9a0298af3}\label{namespacehandle__karpathy__split_a8ecdcbe3665e9190f12c27f9a0298af3}} 
\index{handle\_karpathy\_split@{handle\_karpathy\_split}!initialize\_full\_dict@{initialize\_full\_dict}}
\index{initialize\_full\_dict@{initialize\_full\_dict}!handle\_karpathy\_split@{handle\_karpathy\_split}}
\doxysubsubsection{\texorpdfstring{initialize\_full\_dict()}{initialize\_full\_dict()}}
{\footnotesize\ttfamily def handle\+\_\+karpathy\+\_\+split.\+initialize\+\_\+full\+\_\+dict (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 115 of file handle\+\_\+karpathy\+\_\+split.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{115 \textcolor{keyword}{def }\mbox{\hyperlink{namespacehandle__karpathy__split_a8ecdcbe3665e9190f12c27f9a0298af3}{initialize\_full\_dict}}():}
\DoxyCodeLine{116     train\_dict = \{\}}
\DoxyCodeLine{117     \textcolor{comment}{\# val and test does not need caption\_id nor caption columns}}
\DoxyCodeLine{118     test\_dict = \{}
\DoxyCodeLine{119         \textcolor{stringliteral}{'image\_id'}: [],}
\DoxyCodeLine{120         \textcolor{stringliteral}{'image\_name'}: [],}
\DoxyCodeLine{121     \}}
\DoxyCodeLine{122     val\_dict = \{}
\DoxyCodeLine{123         \textcolor{stringliteral}{'image\_id'}: [],}
\DoxyCodeLine{124         \textcolor{stringliteral}{'image\_name'}: [],}
\DoxyCodeLine{125     \}}
\DoxyCodeLine{126     columns = [\textcolor{stringliteral}{'image\_id'}, \textcolor{stringliteral}{'image\_name'}, \textcolor{stringliteral}{'caption\_id'}, \textcolor{stringliteral}{'caption'}]}
\DoxyCodeLine{127     test\_columns = columns[:2]}
\DoxyCodeLine{128     \textcolor{keywordflow}{for} col \textcolor{keywordflow}{in} columns:}
\DoxyCodeLine{129         train\_dict[col] = []}
\DoxyCodeLine{130     full\_dict = \{\textcolor{stringliteral}{'train'}: train\_dict, \textcolor{stringliteral}{'val'}: val\_dict, \textcolor{stringliteral}{'test'}: test\_dict\}}
\DoxyCodeLine{131     \textcolor{keywordflow}{return} full\_dict, columns, test\_columns}
\DoxyCodeLine{132 }
\DoxyCodeLine{133 }

\end{DoxyCode}
\mbox{\Hypertarget{namespacehandle__karpathy__split_a832828cdfbce5ebae08e00c301006ad3}\label{namespacehandle__karpathy__split_a832828cdfbce5ebae08e00c301006ad3}} 
\index{handle\_karpathy\_split@{handle\_karpathy\_split}!order\_raw\_data\_and\_move\_to\_interim@{order\_raw\_data\_and\_move\_to\_interim}}
\index{order\_raw\_data\_and\_move\_to\_interim@{order\_raw\_data\_and\_move\_to\_interim}!handle\_karpathy\_split@{handle\_karpathy\_split}}
\doxysubsubsection{\texorpdfstring{order\_raw\_data\_and\_move\_to\_interim()}{order\_raw\_data\_and\_move\_to\_interim()}}
{\footnotesize\ttfamily def handle\+\_\+karpathy\+\_\+split.\+order\+\_\+raw\+\_\+data\+\_\+and\+\_\+move\+\_\+to\+\_\+interim (\begin{DoxyParamCaption}\item[{}]{data\+\_\+path,  }\item[{}]{dataset,  }\item[{}]{ann\+\_\+path }\end{DoxyParamCaption})}



Definition at line 9 of file handle\+\_\+karpathy\+\_\+split.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{9 \textcolor{keyword}{def }\mbox{\hyperlink{namespacehandle__karpathy__split_a832828cdfbce5ebae08e00c301006ad3}{order\_raw\_data\_and\_move\_to\_interim}}(data\_path, dataset, ann\_path):}
\DoxyCodeLine{10     data\_path = Path(data\_path)}
\DoxyCodeLine{11     ann\_path = Path(ann\_path)}
\DoxyCodeLine{12     \textcolor{keyword}{with} open(data\_path, \textcolor{stringliteral}{'r'}) \textcolor{keyword}{as} json\_file:}
\DoxyCodeLine{13         data\_dict = json.load(json\_file)}
\DoxyCodeLine{14 }
\DoxyCodeLine{15     full\_dict, columns, test\_columns = \mbox{\hyperlink{namespacehandle__karpathy__split_a8ecdcbe3665e9190f12c27f9a0298af3}{initialize\_full\_dict}}()}
\DoxyCodeLine{16 }
\DoxyCodeLine{17     ann\_dict = \mbox{\hyperlink{namespacehandle__karpathy__split_a21588438406dd53f7fa160f0aa69ace9}{initialize\_ann\_dict}}()}
\DoxyCodeLine{18 }
\DoxyCodeLine{19     ann\_images = \{}
\DoxyCodeLine{20         \textcolor{stringliteral}{"test"}: [],}
\DoxyCodeLine{21         \textcolor{stringliteral}{"val"}: [],}
\DoxyCodeLine{22         \textcolor{stringliteral}{"train"}: []}
\DoxyCodeLine{23     \}}
\DoxyCodeLine{24     ann\_annotations = \{}
\DoxyCodeLine{25         \textcolor{stringliteral}{"test"}: [],}
\DoxyCodeLine{26         \textcolor{stringliteral}{"val"}: [],}
\DoxyCodeLine{27         \textcolor{stringliteral}{"train"}: []}
\DoxyCodeLine{28     \}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30     images = data\_dict[\textcolor{stringliteral}{'images'}]}
\DoxyCodeLine{31 }
\DoxyCodeLine{32     \textcolor{keywordflow}{for} image \textcolor{keywordflow}{in} images:}
\DoxyCodeLine{33         ann\_image\_obj = \{}
\DoxyCodeLine{34             \textcolor{stringliteral}{"license"}: 0,}
\DoxyCodeLine{35             \textcolor{stringliteral}{"url"}: \textcolor{stringliteral}{"www"},}
\DoxyCodeLine{36             \textcolor{stringliteral}{"width"}: 0,}
\DoxyCodeLine{37             \textcolor{stringliteral}{"height"}: 0,}
\DoxyCodeLine{38             \textcolor{stringliteral}{"date\_captured"}: \textcolor{stringliteral}{"yyyy-\/mm-\/dd hh:mm:ss"}}
\DoxyCodeLine{39         \}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41         \textcolor{comment}{\# get image name}}
\DoxyCodeLine{42         image\_name = image[\textcolor{stringliteral}{'filename'}]}
\DoxyCodeLine{43         image\_id = image[\textcolor{stringliteral}{'imgid'}]}
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{comment}{\# add info to ann\_image\_obj}}
\DoxyCodeLine{46         ann\_image\_obj[\textcolor{stringliteral}{'file\_name'}] = image\_name}
\DoxyCodeLine{47         ann\_image\_obj[\textcolor{stringliteral}{'id'}] = image\_id}
\DoxyCodeLine{48 }
\DoxyCodeLine{49         \textcolor{comment}{\# get split}}
\DoxyCodeLine{50         split = image[\textcolor{stringliteral}{'split'}]}
\DoxyCodeLine{51 }
\DoxyCodeLine{52         \textcolor{keywordflow}{if} split \textcolor{keywordflow}{in} \{\textcolor{stringliteral}{"test"}, \textcolor{stringliteral}{"val"}\}:}
\DoxyCodeLine{53             \textcolor{comment}{\# save ann\_image\_obj}}
\DoxyCodeLine{54             ann\_images[split].append(ann\_image\_obj)}
\DoxyCodeLine{55             \textcolor{comment}{\# save image info to .csv files}}
\DoxyCodeLine{56             full\_dict[split][\textcolor{stringliteral}{'image\_id'}].append(image\_id)}
\DoxyCodeLine{57             full\_dict[split][\textcolor{stringliteral}{'image\_name'}].append(image\_name)}
\DoxyCodeLine{58         \textcolor{comment}{\# go through captions and add them to dict split}}
\DoxyCodeLine{59         captions = image[\textcolor{stringliteral}{'sentences'}]}
\DoxyCodeLine{60         sentids = image[\textcolor{stringliteral}{'sentids'}]}
\DoxyCodeLine{61         \textcolor{keywordflow}{for} sentid, caption \textcolor{keywordflow}{in} zip(sentids, captions):}
\DoxyCodeLine{62             ann\_cap\_obj = \{}
\DoxyCodeLine{63                 \textcolor{stringliteral}{"id"}: sentid,}
\DoxyCodeLine{64                 \textcolor{stringliteral}{"image\_id"}: image\_id,}
\DoxyCodeLine{65                 \textcolor{stringliteral}{"caption"}: caption[\textcolor{stringliteral}{'raw'}]}
\DoxyCodeLine{66             \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68             raw\_caption = caption[\textcolor{stringliteral}{'raw'}]}
\DoxyCodeLine{69             caption\_id = image\_name[:-\/4] + \textcolor{stringliteral}{'\#'} + \mbox{\hyperlink{namespacetrain__model_af1334e726c4782724a0e5b8f9e031e01}{str}}(sentid)}
\DoxyCodeLine{70             \textcolor{comment}{\# add info to dicts}}
\DoxyCodeLine{71             \textcolor{keywordflow}{if} split \textcolor{keywordflow}{in} \{\textcolor{stringliteral}{'restval'}, \textcolor{stringliteral}{'train'}\}:}
\DoxyCodeLine{72                 full\_dict[\textcolor{stringliteral}{'train'}][\textcolor{stringliteral}{'image\_id'}].append(image\_id)}
\DoxyCodeLine{73                 full\_dict[\textcolor{stringliteral}{'train'}][\textcolor{stringliteral}{'image\_name'}].append(image\_name)}
\DoxyCodeLine{74                 full\_dict[\textcolor{stringliteral}{'train'}][\textcolor{stringliteral}{'caption\_id'}].append(caption\_id)}
\DoxyCodeLine{75                 full\_dict[\textcolor{stringliteral}{'train'}][\textcolor{stringliteral}{'caption'}].append(raw\_caption)}
\DoxyCodeLine{76                 \textcolor{comment}{\# save ann\_cap\_obj}}
\DoxyCodeLine{77                 ann\_annotations[\textcolor{stringliteral}{'train'}].append(ann\_cap\_obj)}
\DoxyCodeLine{78             \textcolor{keywordflow}{else}:}
\DoxyCodeLine{79                 \textcolor{comment}{\# save ann\_cap\_obj}}
\DoxyCodeLine{80                 ann\_annotations[split].append(ann\_cap\_obj)}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} ann\_path.is\_dir():}
\DoxyCodeLine{83         \textcolor{comment}{\# if this is not a directory then make it, including every}}
\DoxyCodeLine{84         \textcolor{comment}{\# parent that may be missing}}
\DoxyCodeLine{85         ann\_path.mkdir(parents=\textcolor{keyword}{True})}
\DoxyCodeLine{86 }
\DoxyCodeLine{87     \textcolor{keywordflow}{for} s \textcolor{keywordflow}{in} [\textcolor{stringliteral}{"test"}, \textcolor{stringliteral}{"val"}, \textcolor{stringliteral}{"train"}]:}
\DoxyCodeLine{88         ann\_dict[s][\textcolor{stringliteral}{'images'}] = ann\_images[s]}
\DoxyCodeLine{89         ann\_dict[s][\textcolor{stringliteral}{'annotations'}] = ann\_annotations[s]}
\DoxyCodeLine{90         \textcolor{comment}{\# save dict split as .json file}}
\DoxyCodeLine{91         \textcolor{keyword}{with} open(ann\_path.joinpath(dataset + \textcolor{stringliteral}{'\_'} + s + \textcolor{stringliteral}{'.json'}), \textcolor{stringliteral}{'w'}) \(\backslash\)}
\DoxyCodeLine{92                 \textcolor{keyword}{as} ann\_file:}
\DoxyCodeLine{93             json.dump(ann\_dict[s], ann\_file)}
\DoxyCodeLine{94 }
\DoxyCodeLine{95     train\_df = pd.DataFrame(full\_dict[\textcolor{stringliteral}{'train'}], columns=columns)}
\DoxyCodeLine{96     test\_df = pd.DataFrame(full\_dict[\textcolor{stringliteral}{'test'}], columns=test\_columns)}
\DoxyCodeLine{97     val\_df = pd.DataFrame(full\_dict[\textcolor{stringliteral}{'val'}], columns=test\_columns)}
\DoxyCodeLine{98 }
\DoxyCodeLine{99     save\_path = ROOT\_PATH.joinpath(\textcolor{stringliteral}{'data'}, \textcolor{stringliteral}{'interim'}, \textcolor{stringliteral}{'karpathy\_split'})}
\DoxyCodeLine{100     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} save\_path.is\_dir():}
\DoxyCodeLine{101         \textcolor{comment}{\# if dir does not exist create dir}}
\DoxyCodeLine{102         \textcolor{comment}{\# create parents if they do not exist either}}
\DoxyCodeLine{103         save\_path.mkdir(parents=\textcolor{keyword}{True})}
\DoxyCodeLine{104 }
\DoxyCodeLine{105     train\_file = save\_path.joinpath(dataset + \textcolor{stringliteral}{'\_train.csv'})}
\DoxyCodeLine{106     test\_file = save\_path.joinpath(dataset + \textcolor{stringliteral}{'\_test.csv'})}
\DoxyCodeLine{107     val\_file = save\_path.joinpath(dataset + \textcolor{stringliteral}{'\_val.csv'})}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     train\_df.to\_csv(train\_file)}
\DoxyCodeLine{110     test\_df.to\_csv(test\_file)}
\DoxyCodeLine{111     val\_df.to\_csv(val\_file)}
\DoxyCodeLine{112     print(\textcolor{stringliteral}{"finished job!!"})}
\DoxyCodeLine{113 }
\DoxyCodeLine{114 }

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacehandle__karpathy__split_a8e624b6febe4083c1e5950645c0e08b8}\label{namespacehandle__karpathy__split_a8e624b6febe4083c1e5950645c0e08b8}} 
\index{handle\_karpathy\_split@{handle\_karpathy\_split}!ROOT\_PATH@{ROOT\_PATH}}
\index{ROOT\_PATH@{ROOT\_PATH}!handle\_karpathy\_split@{handle\_karpathy\_split}}
\doxysubsubsection{\texorpdfstring{ROOT\_PATH}{ROOT\_PATH}}
{\footnotesize\ttfamily handle\+\_\+karpathy\+\_\+split.\+R\+O\+O\+T\+\_\+\+P\+A\+TH = Path(\+\_\+\+\_\+file\+\_\+\+\_\+).absolute().parents\mbox{[}2\mbox{]}}



Definition at line 6 of file handle\+\_\+karpathy\+\_\+split.\+py.

